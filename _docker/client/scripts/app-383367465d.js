!function(){"use strict";window.ngApp=angular.module("ngseed",["ngCookies","ngTouch","ngResource","ui.router","toastr","pascalprecht.translate","ngWebSocket"]),ngApp.config(["$provide","$logProvider","$translateProvider","toastrConfig",function(n,t,e,r){"ngInject";var i={};i.SVR_URL={base:"http://localhost:9000/docker"},n.value("CONF",i),t.debugEnabled(!0),r.allowHtml=!0,r.timeOut=3e3,r.positionClass="toast-top-right",r.preventDuplicates=!0,r.progressBar=!0;var a=window.localStorage.lang||"zh_CN";e.preferredLanguage(a),e.useSanitizeValueStrategy("escape"),e.useStaticFilesLoader({prefix:"/i18n/",suffix:".json"}),e.useMissingTranslationHandler("regexTranslationHandler")}]),ngApp.run(["$log",function(n){"ngInject";n.debug("已经启动！")}])}(),function(){"use strict";ngApp.config(["$locationProvider","$stateProvider","$urlRouterProvider",function(n,t,e){"ngInject";n.html5Mode(!0),t.state("overview",{url:"/",templateUrl:"app/tpls/pages/overview.tpl.html",controller:"overviewCtrl"}).state("image",{url:"/image",templateUrl:"app/tpls/pages/image/list.tpl.html",controller:"imageListCtrl"}).state("registrys",{url:"/registrys",templateUrl:"app/tpls/pages/registrys.tpl.html",controller:"registrysCtrl"}).state("nodes",{url:"/nodes",templateUrl:"app/tpls/pages/nodes.tpl.html",controller:"nodesCtrl"}).state("container",{url:"/container",templateUrl:"app/tpls/pages/container/list.tpl.html",controller:"containerListCtrl"}).state("containerDetail",{url:"/container/{id}",templateUrl:"app/tpls/pages/container/detail.tpl.html",controller:"containerDetailCtrl"}).state("containerCreate",{url:"/container/create/{imageId}",templateUrl:"app/tpls/pages/container/create.tpl.html",controller:"containerCreateCtrl"}),e.otherwise("/")}])}(),function(){"use strict";ngApp.controller("containerCreateCtrl",["$scope","$stateParams","$element","$websocket","dockerApiSvr",function(n,t,e,r,i){"ngInject";n.imageId=t.imageId}])}(),function(){"use strict";ngApp.controller("containerDetailCtrl",["$scope","$stateParams","$element","$websocket","dockerApiSvr",function(n,t,e,r,i){"ngInject";function a(){i.containers_inspect(n.containerId,function(t){n.container=t.data})}var s=n.containerId=t.id,c="ws://localhost:9000/stats/"+s,o=r(c),l=null;o.onMessage(function(t){var e=n.stats=$.parseJSON(t.data);if(console.log(t.data),e.overview={},null==l)return void(l=e);var r=e.cpu_stats.cpu_usage.total_usage-e.precpu_stats.cpu_usage.total_usage,i=e.cpu_stats.system_cpu_usage-e.precpu_stats.system_cpu_usage;e.overview.cpu_percent=100*r/i,e.overview.memory_percent=100*e.memory_stats.usage/e.memory_stats.limit;var a=0,s=0;for(var c in l.networks){var o=l.networks[c];a+=o.tx_bytes,s+=o.rx_bytes}var d=0,u=0;for(var c in e.networks){var o=e.networks[c];d+=o.tx_bytes,u+=o.rx_bytes}var p=Date.parse(e.read)-Date.parse(l.read);console.log(d),console.log(a),console.log(p),e.overview.networks_up_speed=1e3*(d-a)/p,e.overview.networks_down_speed=1e3*(u-s)/p,e.overview.networks_up=d,e.overview.networks_down=u,l=e}),n.attachUrl="ws://localhost:9000/attach/"+t.id,n.attachStart=!0,n.execUrl="ws://localhost:9000/exec/"+t.id+"/bash",n.execStart=!0,e.find(".tabular.menu > .item").tab(),a()}])}(),function(){"use strict";ngApp.controller("containerListCtrl",["$scope","$element","dockerApiSvr",function(n,t,e){"ngInject";function r(n){e.containers_start(n.Id,function(n){a()})}function i(n){e.containers_stop(n.Id,function(n){a()})}function a(){e.containers(function(t){n.containers=t.data})}a();n["switch"]=function(n,t){return"running"==t.State?i(t):r(t),t.State="changing",!1}}])}(),function(){"use strict";ngApp.controller("footerCtrl",["$scope","$location",function(n,t){"ngInject"}])}(),function(){"use strict";ngApp.controller("imageListCtrl",["$scope","dockerApiSvr",function(n,t){"ngInject";function e(){t.images(function(t){n.images=t.data})}console.log("imageListCtrl"),e()}])}(),function(){"use strict";ngApp.controller("navCtrl",["$scope","$location",function(n,t){"ngInject";n.isActive=function(n){return t.path().match(n)}}])}(),function(){"use strict";ngApp.controller("nodesCtrl",["$scope",function(n){"ngInject"}])}(),function(){"use strict";ngApp.controller("overviewCtrl",["$scope","dockerApiSvr",function(n,t){"ngInject";t.info(function(t){n.info=t,$(".overview .cpu .value").progress({percent:90})}),t.containers(function(t){n.containers=t.data})}])}(),function(){"use strict";ngApp.controller("registrysCtrl",["$scope","dockerApiSvr",function(n,t){"ngInject";n.images=[{star_count:1,is_official:!1,name:"cokappcharlie/aria2",is_trusted:!0,is_automated:!0,description:"aria2 in docker"},{star_count:1,is_official:!1,name:"cokapp/cokwiki",is_trusted:!1,is_automated:!1,description:"CokWiki是运行于Node平台的类Wiki程序"}],n.search=function(){var e={limit:50};n.term?e.term=n.term:e.filters={"is-official":!0},t.images_search(e,function(t){n.images=t})},n.create=function(n){var e={};e.fromImage=n,t.images_create(e,function(n){console.log(n)})}}])}(),function(){"use strict";ngApp.directive("ngEnter",function(){"ngInject";return function(n,t,e){t.bind("keydown keypress",function(t){13===t.which&&(n.$apply(function(){n.$eval(e.ngEnter)}),t.preventDefault())})}})}(),function(){"use strict";ngApp.directive("includeReplace",function(){"ngInject";return{require:"ngInclude",restrict:"A",link:function(n,t,e){t.replaceWith(t.children())}}})}(),function(){"use strict";ngApp.directive("ngSwitch",["$websocket",function(n){"ngInject";return{restrict:"EA",replace:!0,transclude:!0,scope:{ngModel:"=",ngData:"=",disabled:"=",ngTrueValue:"=",ngFalseValue:"=",ngBeforeChange:"&",ngAfterChange:"&"},template:function(n,t){var e='<span class="switch" ng-click="onClick($event)" ng-class="{checked: checked, disabled: disabled}"><small></small><input type="checkbox" ng-model="'+t.ngModel+'" style="display:none" /></span>';return e},link:function(n,t,e){n.onClick=function(t){n.disabled||n.ngBeforeChange(t,n.ngData)&&(r(),i(),n.ngAfterChange(t,n.ngData))},n.$watch("ngModel",function(){i()});var r=function(){n.ngModel=n.ngModel==n.ngTrueValue?n.ngFalseValue:n.ngTrueValue},i=function(){n.checked=n.ngModel==n.ngTrueValue?!0:!1};i()}}}])}(),function(){"use strict";ngApp.directive("ngTerm",["$websocket",function(n){"ngInject";return{restrict:"EA",scope:{url:"=",logs:"@",stdin:"@",start:"="},template:'<div class="ng-term"></div>',replace:!1,link:function(t,e,r){var i=!1,a=function(){var r=new Terminal({cols:100,rows:20,convertEol:!0,useStyle:!0,cursorBlink:!0,screenKeys:!0}),a=n(t.url);a.onMessage(function(n){r.write(n.data)}),a.onClose(function(){r.destroy()}),a.send("\n"),r.open(e.find(".ng-term")[0]),r.on("data",function(n){a.send(n)}),e.on("$destroy",function(){r.destroy()}),i=!0};if(t.start&&a(),!i)var s=t.$watch("start",function(){t.start&&(a(),s())})}}}])}(),function(){"use strict";ngApp.filter("FileSize",function(){"ngInject";return function(n,t,e){if(isNaN(parseFloat(n))||!isFinite(n)||0==n)return"-";"undefined"==typeof t&&(t=1),"undefined"==typeof e&&(e=1024);var r=["bytes","kB","MB","GB","TB","PB"],i=Math.floor(Math.log(n)/Math.log(e));return(n/Math.pow(e,Math.floor(i))).toFixed(t)+" "+r[i]}})}(),function(){"use strict";ngApp.filter("T",["$translate",function(n){"ngInject";return function(t){return t?n.instant(t)|t:void 0}}])}(),function(){"use strict";ngApp.factory("dockerApiSvr",["$rootScope","$http","CONF",function(n,t,e){"ngInject";var r=e.SVR_URL.base;n.cancelEvent=function(n){console.log("cancelEvent");var n=n||window.event;return n.preventDefault&&n.preventDefault(),n.returnValue&&(n.returnValue=!1),!1};var i={};return i.info=function(n){var e=r+"/info",i=t({method:"GET",url:e});i.success(function(t){n(t)})},i.containers=function(n){var e=r+"/containers/json",i=t({method:"GET",url:e});i.success(function(t){n(t)})},i.containers_start=function(n,e){var i=r+"/containers/"+n+"/start",a=t({method:"POST",url:i});a.success(function(n){e(n)})},i.containers_stop=function(n,e){var i=r+"/containers/"+n+"/stop",a=t({method:"POST",url:i});a.success(function(n){e(n)})},i.containers_inspect=function(n,e){var i=r+"/containers/"+n+"/json",a=t({method:"GET",url:i});a.success(function(n){e(n)})},i.exec_start=function(n,e){var i=r+"/exec/"+n+"/start",a=t({method:"POST",url:i,headers:{"Content-Type":"application/json"},data:{Detach:!1,Tty:!0}});a.success(function(n){e(n)})},i.images=function(n){var e=r+"/images/json",i=t({method:"GET",url:e});i.success(function(t){n(t)})},i.images_search=function(n,e){var i=r+"/images/search",a=t({method:"GET",url:i,params:n});a.success(function(n){e(n)})},i.images_create=function(n,e){var i=r+"/images/create",a=t({method:"POST",url:i,data:n});a.success(function(n){e(n)})},i}])}(),function(){"use strict";ngApp.factory("regexTranslationHandler",["$translate",function(n){"ngInject";return function(t){var e=t,r=n.getTranslationTable();for(var i in r){var a=new RegExp(i).exec(t);if(null!=a){e=r[i];for(var s=1;s<a.length;s++)e=e.replace("{{"+s+"}}",a[s])}}return e}}])}(),angular.module("dockress").run(["$templateCache",function(n){n.put("app/tpls/pages/nodes.tpl.html",'<div class="container pages">\r\n\r\nnodes\r\n\r\n\r\n</div>'),n.put("app/tpls/pages/overview.tpl.html",'<div class="container pages overview">\r\n    <div class="ui grid usage">\r\n        <div class="eight wide column">\r\n            <div class="cpu clearfix">\r\n                <div class="left">\r\n                </div>\r\n                <div class="right">\r\n                    <div class="title">CPU使用率</div>\r\n                    <div class="value">{{info.NFd}}</div>\r\n                    <div class="ui tiny progress">\r\n                        <div class="bar"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="eight wide column">\r\n            <div class="ram clearfix">\r\n                <div class="left">\r\n                </div>\r\n                <div class="right">\r\n                    <div class="title">内存使用率</div>\r\n                    <div class="value">{{info.MemTotal}}</div>\r\n                    <div class="ui tiny progress">\r\n                        <div class="bar"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="ui grid containers">\r\n        <div class="four wide column" ng-repeat="container in containers | orderBy:\'Created\'">\r\n            <div class="container">\r\n                <h1>{{container.Names[0]}}</h1>\r\n                <p>{{container.Status}}</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),n.put("app/tpls/pages/registrys.tpl.html",'<div class="container text pages registrys">\r\n    <div class="search-wrapper">\r\n        <div class="ui icon input fluid">\r\n            <input ng-enter="search()" class="prompt" ng-model="term" type="text" placeholder="{{\'registrys.search_images\'|translate}}">\r\n            <i ng-click="search()" class="search icon"></i>\r\n        </div>\r\n    </div>\r\n    <table class="ui large table">\r\n        <thead>\r\n            <tr>\r\n                <th>名称</th>\r\n                <th>认证</th>\r\n                <th>描述</th>\r\n                <th>操作</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <tr ng-repeat="image in images | orderBy:\'star_count\'">\r\n                <td>\r\n                    <div class="ui label">\r\n                        {{image.name}}\r\n                    </div>\r\n                </td>\r\n                <td class="certificate">\r\n                    <i class="iconfont icon-trusted" ng-class="{active: image.is_trusted}"></i>\r\n                    <i class="iconfont icon-official" ng-class="{active: image.is_official}"></i>\r\n                </td>\r\n                <td>\r\n                    {{image.description}}\r\n                </td>\r\n                <td>\r\n                    <button class="ui primary button" ng-click="create(image.name)">\r\n                        {{\'registrys.pull\'|translate}}\r\n                    </button>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n'),n.put("app/tpls/public/footer.tpl.html",'<div ng-controller="footerCtrl">\r\n\r\n</div>\r\n'),n.put("app/tpls/public/header.tpl.html",'<div class="app-header">\r\n    <div class="ui left icon input fluid">\r\n        <input class="search prompt" type="text" placeholder="{{\'header.search\'|translate}}">\r\n        <i class="search icon"></i>\r\n    </div>\r\n</div>\r\n'),n.put("app/tpls/public/main.tpl.html",'<div class="app-main">\r\n    <div ng-include="\'app/tpls/public/header.tpl.html\'" include-replace></div>\r\n    <div class="app-content" ui-view></div>\r\n    <div ng-include="\'app/tpls/public/footer.tpl.html\'" include-replace></div>\r\n</div>\r\n'),n.put("app/tpls/public/sidebar.tpl.html",'<div class="app-sidebar" ng-controller="navCtrl">\r\n    <div class="logo">\r\n        Dockress\r\n    </div>\r\n    <ul class="nav-vertical">\r\n        <li class="item" ng-class="{active :isActive(\'^/$\')}"><a ui-sref="overview"><i class="dashboard layout icon"></i> {{\'header.overview\'|translate}}</a></li>\r\n        <li class="item" ng-class="{active :isActive(\'/container\')}"><a ui-sref="container"><i class="cubes icon"></i> {{\'header.containers\'|translate}}</a></li>\r\n        <li class="item" ng-class="{active :isActive(\'/image\')}"><a ui-sref="image"><i class="database icon"></i> {{\'header.images\'|translate}}</a></li>\r\n        <li class="item" ng-class="{active :isActive(\'/registrys\')}"><a ui-sref="registrys"><i class="cloud icon"></i> {{\'header.registrys\'|translate}}</a></li>\r\n        <li class="item" ng-class="{active :isActive(\'/nodes\')}"><a ui-sref="nodes"><i class="sitemap icon"></i> {{\'header.nodes\'|translate}}</a></li>\r\n    </ul>\r\n</div>\r\n'),n.put("app/tpls/pages/container/create.tpl.html",'<div class="app-container-create">\r\n    {{imageId}}\r\n    <div class="ui grid">\r\n        <div class="sixteen wide column">\r\n            <section class="name">\r\n            	\r\n            </section>\r\n        </div>\r\n        <div class="eight wide column">\r\n            <section class="port-bindings">\r\n            </section>\r\n        </div>\r\n        <div class="eight wide column">\r\n            <section class="binds">\r\n            </section>\r\n        </div>\r\n        <div class="eight wide column">\r\n            <section class="env">\r\n            </section>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),n.put("app/tpls/pages/container/detail.tpl.html",'<div class="app-container">\r\n    <div class="head">\r\n        {{container.Name}}\r\n    </div>\r\n    <div class="overview">\r\n        <ul>\r\n            <li class="status">\r\n                {{container.State.Status}}\r\n            </li>\r\n            <li class="cpu">\r\n                {{stats.overview.cpu_percent | number:2}}%\r\n            </li>\r\n            <li class="ram">\r\n                {{stats.overview.memory_percent | number:2}}%\r\n                {{stats.memory_stats.usage | FileSize:1:1000}} of {{stats.memory_stats.limit | FileSize:1:1000}}\r\n            </li>\r\n            <li class="net">\r\n                上行：{{stats.overview.networks_up_speed | FileSize:2:1000}}\r\n                下行：{{stats.overview.networks_down_speed | FileSize:2:1000}}\r\n            </li>\r\n            <li class="net-total">\r\n                上行吞吐量：{{stats.overview.networks_up | FileSize:2:1000}}\r\n                下行吞吐量：{{stats.overview.networks_down | FileSize:2:1000}}\r\n            </li>\r\n\r\n        </ul>\r\n    </div>\r\n    <div class="text pages">\r\n        <div class="ui top attached tabular menu">\r\n            <a class="item active" data-tab="attach">Attach</a>\r\n            <a class="item" data-tab="exec">Exec</a>\r\n        </div>\r\n        <div class="ui bottom attached tab segment active" data-tab="attach">\r\n            <div ng-term2 url="attachUrl" start="attachStart"></div>\r\n        </div>\r\n        <div class="ui bottom attached tab segment" data-tab="exec">\r\n            <div ng-term url="execUrl" start="execStart"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),n.put("app/tpls/pages/container/list.tpl.html",'<div class="app-containers">\r\n    <table class="ui table">\r\n        <thead>\r\n            <tr>\r\n                <th>ID</th>\r\n                <th>名称</th>\r\n                <th>镜像</th>\r\n                <th>状态</th>\r\n                <th>操作</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <tr ng-repeat="container in containers | orderBy:\'Created\'">\r\n                <td>\r\n                    <a ui-sref="containerDetail({id: container.Id})">{{container.Id | limitTo : 12}}</a>\r\n                </td>\r\n                <td>\r\n                    {{container.Names[0]}}</div>\r\n                </td>\r\n                <td>     \r\n                    {{container.Image}}\r\n                </td>\r\n                <td>     \r\n                    <div class="ui label" ng-class="{\'running\':\'green\', \'exited\':\'red\'}[container.State]">{{\'containers.\' + container.State|translate}}</div><br>\r\n                    <span class="small">{{\'containers.\' + container.Status|translate}}</span>\r\n                </td>\r\n                <td>\r\n                    <div ng-switch disabled="{\'changing\': true}[container.State]" ng-before-change="switch($event, container)" ng-data="container" ng-model="container.State" ng-true-value="\'running\'" ng-false-value="\'exited\'"></div>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n'),n.put("app/tpls/pages/image/list.tpl.html",'<div class="container text pages images">\r\n    <div class="toolbar">\r\n        <button class="ui labeled icon primary button">\r\n            <i class="refresh icon"></i> {{\'images.refresh\'|translate}}\r\n        </button>\r\n        <button class="ui labeled icon primary button">\r\n            <i class="cloud download icon"></i> {{\'images.pull\'|translate}}\r\n        </button>\r\n    </div>\r\n    <table class="ui large table">\r\n        <thead>\r\n            <tr>\r\n                <th>ID</th>\r\n                <th>名称</th>\r\n                <th>创建时间</th>\r\n                <th>占用空间</th>\r\n                <th>操作</th>\r\n            </tr>\r\n        </thead>\r\n        <tbody>\r\n            <tr ng-repeat="image in images | orderBy:\'Created\'">\r\n                <td>\r\n                    {{image.Id | limitTo : 12 : 7}}\r\n                </td>\r\n                <td>\r\n                    <div class="ui label">\r\n                        {{image.RepoTags[0]}}\r\n                    </div>\r\n                </td>\r\n                <td>\r\n                    {{image.Created * 1000 | date:\'yyyy-MM-dd HH:mm:ss Z\'}}\r\n                </td>\r\n                <td>\r\n                    <span>{{image.VirtualSize | FileSize}}</span>\r\n                </td>\r\n                <td>\r\n                    <button  ui-sref="containerCreate({imageId: image.Id})" class="ui primary button">\r\n                        启动\r\n                    </button>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n')}]);
//# sourceMappingURL=../maps/scripts/app-383367465d.js.map
